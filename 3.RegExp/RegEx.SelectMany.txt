
using System.LINQ;

public void Main()
{
    string SourceFolder = Dts.Variables["User::SourceFolder"].Value.ToString();
    string TargetFolder = Dts.Variables["User::TargetFolder"].Value.ToString();
    string LogFolder = Dts.Variables["User::LogFolder"].Value.ToString();
    string FilePattern = Dts.Variables["User::FilePattern"].Value.ToString();

    string delimiter = string.Empty;
    string header = string.Empty;
    string trailer = string.Empty;
    string logFileName = LogFolder + "\\Log_" + DateTime.Now.ToString("yyyy-MM-dd_HHmm") + ".txt";
    string errFileName = LogFolder + "\\Err_" + DateTime.Now.ToString("yyyy-MM-dd_HHmm") + ".txt";

    //log
    File.AppendAllText(logFileName, "started on: " + DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss") + Environment.NewLine);

    try
    {
        string[] filters = Regex.Replace(FilePattern, @"\s+", string.Empty).Split(',');
        string[] filePaths = filters.SelectMany(f => Directory.GetFiles(SourceFolder, f)).ToArray();
        foreach (string f in filePaths)
        {
            string[] lines = System.IO.File.ReadAllLines(f);

            Regex regex = new Regex(@"([,|\x09])");       //comma, pipe, tab
            var matches = regex.Matches(lines[0]);
            if (matches.Count > 0)
            {
                delimiter = matches[0].Value;
                if (delimiter == ",")
                    delimiter = "CSV";
                else if (delimiter == "|")
                    delimiter = "PIPE";
                else
                    delimiter = "TAB";
            }
            else
                delimiter = "FIX";

            header = "HH,FILE TYPE=AA,FORMAT=<" + delimiter + ">,DATE=" + DateTime.Now.ToShortDateString();
            trailer = lines.Length.ToString("TAIL000000000");

            //write new file
            string targetName = TargetFolder + "\\" + Path.GetFileName(f);
            File.WriteAllText(targetName, header + Environment.NewLine);
            System.IO.File.AppendAllLines(targetName, lines);
            File.AppendAllText(targetName, trailer + Environment.NewLine);

            //log
            File.AppendAllText(logFileName, "filename: " + f + Environment.NewLine);
        }

        //log
        File.AppendAllText(logFileName, "finished on: " + DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss") + Environment.NewLine);

        Dts.TaskResult = (int)ScriptResults.Success;
    }
    catch (Exception exception)
    {
        // Create Log File for Errors
        using (StreamWriter sw = File.CreateText(errFileName))
        {
            sw.WriteLine(exception.ToString());
            Dts.TaskResult = (int)ScriptResults.Failure;
        }
    }

}

--- ssis_Load.dtsConfig
<?xml version="1.0"?>
<DTSConfiguration>
    <DTSConfigurationHeading>
        <DTSConfigurationFileInfo GeneratedBy="me" GeneratedFromPackageName="ssis_Load" GeneratedFromPackageID="{F63C2CB6-73DD-4AEA-963B-9AA75A23265F}" GeneratedDate="4/11/2018 4:44:02 PM"/>
    </DTSConfigurationHeading>
    <Configuration ConfiguredType="Property" Path="\Package.Variables[User::FilePattern].Properties[Value]" ValueType="String">
        <ConfiguredValue>A*.txt, B*.csv, C*.txt</ConfiguredValue>
    </Configuration>
    <Configuration ConfiguredType="Property" Path="\Package.Variables[User::LogFolder].Properties[Value]" ValueType="String">
        <ConfiguredValue>C:\TEST\DataSource</ConfiguredValue>
    </Configuration>
    <Configuration ConfiguredType="Property" Path="\Package.Variables[User::SourceFolder].Properties[Value]" ValueType="String">
        <ConfiguredValue>C:\TEST\DataSource</ConfiguredValue>
    </Configuration>
    <Configuration ConfiguredType="Property" Path="\Package.Variables[User::TargetFolder].Properties[Value]" ValueType="String">
        <ConfiguredValue>C:\TEST\DataTarget</ConfiguredValue>
    </Configuration>
</DTSConfiguration>
